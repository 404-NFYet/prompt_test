name: Discord Notification

on:
  push:

jobs:
 notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send Discord Notification
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          AUTHOR="${{ github.actor }}"
          REPO="${{ github.repository }}"
          BRANCH="${{ github.ref_name }}"
          COMMIT_MSG="${{ github.event.head_commit.message }}"
          COMMIT_URL="${{ github.event.head_commit.url }}"

          if [ -z "$COMMIT_MSG" ]; then
            COMMIT_MSG="ì»¤ë°‹ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤"
          fi

          cat <<EOF > payload.json
          {
            "content": "ğŸš€ **ìƒˆë¡œìš´ ì½”ë“œ í‘¸ì‹œ ì•Œë¦¼**\n\nğŸ‘¤ ì‘ì—…ì: **$AUTHOR**\nğŸŒ¿ ë¸Œëœì¹˜: **$BRANCH**\nğŸ“¦ ì €ì¥ì†Œ: **$REPO**\nğŸ“ ì»¤ë°‹ ë‚´ìš©:\n$COMMIT_MSG\n\nğŸ”— ì»¤ë°‹ í™•ì¸í•˜ê¸°:\n$COMMIT_URL"
          }
          EOF

          curl -H "Content-Type: application/json" \
               -d @payload.json \
               "$DISCORD_WEBHOOK"
